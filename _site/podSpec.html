<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Welcome | 这里是我的个人空间，欢迎你的访问！</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="Welcome" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="这里是我的个人空间，欢迎你的访问！" />
<meta property="og:description" content="这里是我的个人空间，欢迎你的访问！" />
<link rel="canonical" href="http://localhost:4000/podSpec.html" />
<meta property="og:url" content="http://localhost:4000/podSpec.html" />
<meta property="og:site_name" content="Welcome" />
<script type="application/ld+json">
{"description":"这里是我的个人空间，欢迎你的访问！","@type":"WebPage","url":"http://localhost:4000/podSpec.html","headline":"Welcome","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Welcome</h1>
      <h2 class="project-tagline">这里是我的个人空间，欢迎你的访问！</h2>
      
      
    </section>

    <section class="main-content">
      <h1 id="cocoapodspods-公有库创建">cocoapodsPods 公有库创建</h1>

<ol>
  <li>pod lib create KKLPush</li>
  <li>添加文件到 classes中</li>
  <li>执行 pod install</li>
  <li>推送到远端</li>
  <li>添加 tag</li>
  <li>检查有效性
    <blockquote>
      <p>pod lib lint –allow-warnings</p>
    </blockquote>
  </li>
  <li>
    <blockquote>
      <p>pod trunk push –allow-warnings</p>
    </blockquote>
  </li>
</ol>

<h1 id="开课啦cocoapods私有库创建教程">开课啦CocoaPods私有库创建教程</h1>

<h3 id="创建私有-spec-repo">创建私有 Spec Repo</h3>

<p>先来说第一步，什么是Spec Repo？它是所有的Pods的一个索引，就是一个容器，所有公开的Pods都在这个里面，它实际是一个Git仓库remote端在GitHub上，但是当你使用了Cocoapods后它会被clone到本地的~/.cocoapods/repos目录下，可以进入到这个目录看到master文件夹就是这个官方的Spec Repo了。</p>

<p>因此我们需要创建一个类似于master的私有Spec Repo。我们可以创建一个私有的git仓库当做我们自己的Spec Repo。（已经在公司的gitlab上创建好了名叫<a href="http://git.mistong.com/ios-framework/mistong-repo">mistong-repo</a>的私有Spec Repo）</p>

<p>创建完成之后在Terminal中执行如下命令</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pod repo add mistong ssh://git@git.mistong.com:10022/ios-framework/mistong-repo.git
</code></pre></div></div>

<p>此时如果成功的话进入到~/.cocoapods/repos目录下就可以看到 <code class="highlighter-rouge">mistong</code> 这个目录了。至此我们的pod就能在本地search到 <code class="highlighter-rouge">mistong</code> 里申明的所有库了。</p>

<h3 id="创建cocoapods私有库">创建CocoaPods私有库</h3>

<p>参考<a href="http://www.jianshu.com/p/c6c227c0c221">CocoaPods建立私有仓库 spec repo</a></p>

<p>现在我们来创建一个私有库，以KKLKit为例。</p>

<p>在Terminal中执行如下命令</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pod lib create KKLKit
</code></pre></div></div>

<p>之后他会问你几个问题，1. 选择开发语言 2.是否需要一个例子工程；3.选择一个测试框架；4.是否基于View测试；5.类的前缀；这几个问题的具体介绍可以去看官方文档，我这里选择的是1.ObjC  ;2.Yes；3.None；4.None；4.KKL。 问完这几个问题他会自动执行pod install命令创建项目并生成依赖。</p>

<p>_Pods.xcodeproj文件在这里并没有什么作用，可以直接删掉。 其中KKLKit目录仅包含了KKLKit的源文件及图片资源等文件，Example目录则包含了KKLKit相关的demo。我们在编写KKLKit的源码的时候，直接在Example的工程中进行。</p>

<p>现在我们进入Example目录，打开.workspace文件。
可以看到，Development Pods目录下的KKLKit目录就是我们的库源码。可以直接修改该目录下的代码。需要注意的是，如果需要在KKLKit中增加或删除文件，在增加文件后，需要在Example的根目录，执行一下<code class="highlighter-rouge">pod install </code> 命令。</p>

<h3 id="发布私有库">发布私有库</h3>

<ul>
  <li>编辑podspec文件，发布版本库前，需要先配置好podspec文件，具体模板可以参考<a href="http://git.mistong.com/ios-framework/CKKit/blob/master/CKKit.podspec">CKKit.podspec</a>。
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#
# Be sure to run `pod lib lint CKKit.podspec' to ensure this is a
# valid spec before submitting.
#
# Any lines starting with a # are optional, but their use is encouraged
# To learn more about a Podspec see http://guides.cocoapods.org/syntax/podspec.html
#
Pod::Spec.new do |s|
s.name             = 'CKKit'
s.version          = '0.1.11'
s.summary          = 'CKKit是一个工具类的库'
# This description is used to generate tags and improve search results.
#   * Think: What does it do? Why did you write it? What is the focus?
#   * Try to keep it short, snappy and to the point.
#   * Write the description between the DESC delimiters below.
#   * Finally, don't worry about the indent, CocoaPods strips it!
s.description      = &lt;&lt;-DESC
CKKit是一个工具类的库，主要包含容器类、通知、数据源相关的管理类及工具类
                     DESC
s.homepage         = 'http://git.mistong.com/ios-framework/CKKit'
# s.screenshots     = 'www.example.com/screenshots_1', 'www.example.com/screenshots_2'
s.license          = { :type =&gt; 'MIT', :file =&gt; 'LICENSE' }
s.author           = { 'jiangjunchen' =&gt; 'jiangjunchen@kaike.la' }
s.source           = { :git =&gt; 'ssh://git@git.mistong.com:10022/ios-framework/CKKit.git', :tag =&gt; s.version.to_s }
# s.social_media_url = 'https://twitter.com/&lt;TWITTER_USERNAME&gt;'
# s.module_map = 'CKKit/CKKit.modulemap'
s.ios.deployment_target = '8.0'
s.source_files = 'CKKit/Classes/CKKit.h'
s.subspec 'Base' do |ss|
    ss.source_files = 'CKKit/Classes/Base/**/*'
end
s.subspec 'UIKit' do |ss|
    ss.source_files = 'CKKit/Classes/UIKit/**/*'
    ss.dependency 'CKKit/Base'
end
# s.source_files = 'CKKit/Classes/**/*'
# s.resource_bundles = {
#   'CKKit' =&gt; ['CKKit/Assets/*.png']
# }
# s.public_header_files = 'Pod/Classes/**/*.h'
# s.frameworks = 'UIKit', 'MapKit'
# s.dependency 'AFNetworking', '~&gt; 2.3'
end
</code></pre></div>    </div>
  </li>
</ul>

<p>上传后保存会有目录结构<br />
<img src="http://note.youdao.com/yws/res/1892/WEBRESOURCEba18671e1fe66bf403fecade8204e488" alt="" /></p>

<ul>
  <li>
    <p>git commit后，需要打tag，并push到远程。如</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git tag <span class="nt">-m</span> <span class="s2">"first release"</span> <span class="s2">"0.1.0"</span> 
<span class="nv">$ </span>git push <span class="nt">--tags</span>     <span class="c">#推送tag到远端仓库</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>验证私有库的正确性</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pod lib lint <span class="nt">--allow-warnings</span>
</code></pre></div>    </div>

    <p>验证成功</p>
  </li>
  <li>
    <p>向Spec Repo提交podspec。 向我们的私有Spec Repo提交podspec只需要一个命令</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pod repo push mistong ./KKLKit.podspec <span class="nt">--allow-warnings</span>
</code></pre></div>    </div>
    <p>其中，<code class="highlighter-rouge">mistong</code>就是我们的私有Spec Repo，<code class="highlighter-rouge">./KKLKit.podspec</code>则是我们私有库的描述文件路径</p>
  </li>
</ul>

<h4 id="注如果podspec的依赖包含你自己的私有库那么验证命令后面要填写你所依赖的那个私有库的连接地址和cocoapods的默认地址">注：如果podspec的依赖包含你自己的私有库。那么验证命令后面要填写你所依赖的那个私有库的连接地址和cocoapods的默认地址</h4>

<p>如：$ pod lib lint –sources=’ssh://git@git.mistong.com:10022/ios-framework/mistong-repo.git,https://github.com/CocoaPods/Specs’ –use-libraries –allow-warnings</p>

<h3 id="安装私有库">安装私有库</h3>

<p>安装私有库需要在Podfile文件顶部申明一下我们的私有Repo Spec地址，以及pod公共的Repo Spec地址。 再在podfile中通过<code class="highlighter-rouge">pod 'CKKit', '~&gt; 0.0.1'</code>来申明私有库</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> <span class="s1">'ssh://git@git.mistong.com:10022/ios-framework/mistong-repo.git'</span>
<span class="nb">source</span> <span class="s1">'https://github.com/CocoaPods/Specs.git'</span>
</code></pre></div></div>

<h3 id="关于resources"><a href="http://blog.xianqu.org/2015/08/pod-resources/">关于Resources</a></h3>

<p>新版的cocoapods推荐在podspec使用<code class="highlighter-rouge">resource_bundle</code>方式引用资源文件：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s.resource_bundle = {'LibName' =&gt; ['LibName/*.png']}
</code></pre></div></div>

<p>理论上一个 bundle 里可以有一个 asset catalog。Xcode 最后会把它们编译成 <code class="highlighter-rouge">Assets.car</code> 文件。但是使用<code class="highlighter-rouge">resource_bundle</code>这种方式对<code class="highlighter-rouge">Image.xcassets</code>支持不太好，会出现找不到图片的情况。所以增对图片资源，要么不使用xcassets，直接将图片放到文件目录中；要么使用podspec的resources方式添加图片的xcassets。</p>

<p>我这里推荐采用resources方式添加图片资源，因为pdf格式的图片需要放到xcassets中才能直接使用：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s.resources = 'XHXUser/Assets/**/*'
</code></pre></div></div>

<p>那么在代码中可以用如下方式获取pod库中的图片资源:</p>

<pre><code class="language-objective-c">NSBundle *bundle = [NSBundle bundleForClass:[XHXUserAPI class]];
UIImage *image = [UIImage imageNamed:@"LoginLogo" inBundle:bundle compatibleWithTraitCollection:nil];
</code></pre>

<p>当然，你可以在pod库内部创建一个宏<code class="highlighter-rouge">ModuleImage</code>，用于获取私有库内部的图片:</p>

<pre><code class="language-objective-c">// 根据图片名，获取模块内部的图片
#define ModuleImage(name) [UIImage imageNamed:(name) inBundle:[NSBundle bundleForClass:[self class]] compatibleWithTraitCollection:nil]
</code></pre>

<p><a href="./">返回</a></p>


      <footer class="site-footer">
        
        <span class="site-footer-credits">This page was created by <a href="">zoolar</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
